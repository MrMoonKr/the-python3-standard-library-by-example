<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>dis — Python Bytecode Disassembler &mdash; PyMOTW 3</title>

    <link rel="stylesheet" href="../_static/pure-min.css" type="text/css">
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/font-awesome/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pymotw.css" type="text/css">

    <link rel="shortcut icon" type="image/png" href="../_static/favicon.png">

    <link rel="alternate" type="application/atom+xml"
          title="Doug Hellmann"
          href="https://feeds.feedburner.com/DougHellmann" />
    <link rel="alternate" type="application/atom+xml"
          title="PyMOTW Updates"
          href="https://feeds.feedburner.com/PyMOTW" />

    <meta name="verify-v1" content="5saTcOa2HLac4V85yUg3SARfun1PqT5Upu7IR/6fpv4="/>

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@pymotw" />
    <meta name="twitter:title" content="dis — Python Bytecode Disassembler" />
    <meta name="twitter:image" content="https://pymotw.com/3/_static/logo-large.png" />

  </head>
  <body>

    <div class="pure-menu pure-menu-open pure-menu-horizontal" id="site-menu">
      <a class="pure-menu-heading" href="../index.html"><img src="../_static/logo.png"> PyMOTW-3</a>

      <ul id="top-menu">
        <li class="pure-menu-selected"><a href="../py-modindex.html"><i class="fa fa-list fa-lg"></i> Module Index</a></li>
        <li class="pure-menu-selected"><a href="../genindex.html"><i class="fa fa-italic fa-lg"></i> Index</a></li>
        <li class="pure-menu-selected"><a class="sociallink" href="http://www.twitter.com/pymotw"
       title="Twitter">
      <i class="fa fa-twitter fa-lg"></i></a></a>
        <li class="pure-menu-selected"><a class="sociallink" href="https://feeds.feedburner.com/PyMOTW"
       title="Subscribe via RSS">
      <i class="fa fa-rss-square fa-lg"></i></a></li>
      </ul>

    </div>

    <div class="pure-menu pure-menu-open pure-menu-vertical" id="breadcrumbs-menu">
      
      <ul id="breadcrumbs">
        <li class="pure-menu-selected"><a href="../language.html"><i class="fa fa-arrow-circle-up"></i> Language Tools</a></li>
      </ul>
    </div>

    <div class="pure-g-r" id="content-container">

      <div class="pure-u-3-4">
        <div class="content">
          
  <div class="section" id="module-dis">
<span id="dis-python-bytecode-disassembler"></span><h1>dis — Python Bytecode Disassembler<a class="headerlink" href="#module-dis" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Convert code objects to a human-readable representation of
the bytecodes for analysis.</td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal notranslate"><span class="pre">dis</span></code> module includes functions for working with Python
bytecode by <em>disassembling</em> it into a more human-readable form.
Reviewing the bytecodes being executed by the interpreter is a good
way to hand-tune tight loops and perform other kinds of optimizations.
It is also useful for finding race conditions in multi-threaded
applications, since it can be used to estimate the point in the code
where thread control may switch.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The use of bytecodes is a version-specific implementation detail of
the CPython interpreter.  Refer to <code class="docutils literal notranslate"><span class="pre">Include/opcode.h</span></code> in the
source code for the version of the interpreter you are using to
find the canonical list of bytecodes.</p>
</div>
<div class="section" id="basic-disassembly">
<h2>Basic Disassembly<a class="headerlink" href="#basic-disassembly" title="Permalink to this headline">¶</a></h2>
<p>The function <code class="docutils literal notranslate"><span class="pre">dis()</span></code> prints the disassembled representation of a
Python code source (module, class, method, function, or code object).
A module such as <code class="docutils literal notranslate"><span class="pre">dis_simple.py</span></code> can be disassembled by running
<code class="docutils literal notranslate"><span class="pre">dis</span></code> from the command line.</p>
<div class="literal-block-wrapper with-linenos docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">dis_simple.py</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># encoding: utf-8</span>

<span class="n">my_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<p>The output is organized into columns with the original source line
number, the instruction address within the code object, the opcode
name, and any arguments passed to the opcode.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 -m dis dis_simple.py

  4           0 LOAD_CONST               0 (&#39;a&#39;)
              2 LOAD_CONST               1 (1)
              4 BUILD_MAP                1
              6 STORE_NAME               0 (my_dict)
              8 LOAD_CONST               2 (None)
             10 RETURN_VALUE
</pre></div>
</div>
<p>In this case, the source translates to four different operations to
create and populate the dictionary, then save the results to a local
variable.  Since the Python interpreter is stack-based, the first
steps are to put the constants onto the stack in the correct order
with <code class="docutils literal notranslate"><span class="pre">LOAD_CONST</span></code>, and then use <code class="docutils literal notranslate"><span class="pre">BUILD_MAP</span></code> to pop off
the new key and value to be added to the dictionary.  The resulting
<code class="docutils literal notranslate"><span class="pre">dict</span></code> object is bound to the name <code class="docutils literal notranslate"><span class="pre">my_dict</span></code> with
<code class="docutils literal notranslate"><span class="pre">STORE_NAME</span></code>.</p>
</div>
<div class="section" id="disassembling-functions">
<h2>Disassembling Functions<a class="headerlink" href="#disassembling-functions" title="Permalink to this headline">¶</a></h2>
<p>Unfortunately, disassembling an entire module does not recurse into
functions automatically.</p>
<div class="literal-block-wrapper with-linenos docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">dis_function.py</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># encoding: utf-8</span>


<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">nargs</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">dis</span>
    <span class="n">dis</span><span class="o">.</span><span class="n">dis</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<p>The results of disassembling <code class="docutils literal notranslate"><span class="pre">dis_function.py</span></code> show the operations
for loading the function’s code object onto the stack and then turning
it into a function (<code class="docutils literal notranslate"><span class="pre">LOAD_CONST</span></code>, <code class="docutils literal notranslate"><span class="pre">MAKE_FUNCTION</span></code>), followed by
the body of the function.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 -m dis dis_function.py

  5           0 LOAD_CONST               0 (&lt;code object f at
0x102c2df60, file &quot;dis_function.py&quot;, line 5&gt;)
              2 LOAD_CONST               1 (&#39;f&#39;)
              4 MAKE_FUNCTION            0
              6 STORE_NAME               0 (f)

 10           8 LOAD_NAME                1 (__name__)
             10 LOAD_CONST               2 (&#39;__main__&#39;)
             12 COMPARE_OP               2 (==)
             14 POP_JUMP_IF_FALSE       34

 11          16 LOAD_CONST               3 (0)
             18 LOAD_CONST               4 (None)
             20 IMPORT_NAME              2 (dis)
             22 STORE_NAME               2 (dis)

 12          24 LOAD_NAME                2 (dis)
             26 LOAD_METHOD              2 (dis)
             28 LOAD_NAME                0 (f)
             30 CALL_METHOD              1
             32 POP_TOP
        &gt;&gt;   34 LOAD_CONST               4 (None)
             36 RETURN_VALUE

Disassembly of &lt;code object f at 0x102c2df60, file
&quot;dis_function.py&quot;, line 5&gt;:
  6           0 LOAD_GLOBAL              0 (len)
              2 LOAD_FAST                0 (args)
              4 CALL_FUNCTION            1
              6 STORE_FAST               1 (nargs)

  7           8 LOAD_GLOBAL              1 (print)
             10 LOAD_FAST                1 (nargs)
             12 LOAD_FAST                0 (args)
             14 CALL_FUNCTION            2
             16 POP_TOP
             18 LOAD_CONST               0 (None)
             20 RETURN_VALUE
</pre></div>
</div>
<p>Earlier versions of Python did not include function bodies in module
disassemblies automatically.  To see the disassembled version of a
function, pass the function directly to <code class="docutils literal notranslate"><span class="pre">dis()</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 dis_function.py

  6           0 LOAD_GLOBAL              0 (len)
              2 LOAD_FAST                0 (args)
              4 CALL_FUNCTION            1
              6 STORE_FAST               1 (nargs)

  7           8 LOAD_GLOBAL              1 (print)
             10 LOAD_FAST                1 (nargs)
             12 LOAD_FAST                0 (args)
             14 CALL_FUNCTION            2
             16 POP_TOP
             18 LOAD_CONST               0 (None)
             20 RETURN_VALUE
</pre></div>
</div>
<p>To print a summary of the function, including information about the
arguments and names it uses, call <code class="docutils literal notranslate"><span class="pre">show_code()</span></code>, passing the
function as the first argument.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># encoding: utf-8</span>


<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">nargs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">nargs</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">dis</span>
    <span class="n">dis</span><span class="o">.</span><span class="n">show_code</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
<p>The argument to <code class="docutils literal notranslate"><span class="pre">show_code()</span></code> is passed to <code class="docutils literal notranslate"><span class="pre">code_info()</span></code>,
which returns a nicely formatted summary of the function, method, code
string, or other code object, ready to be printed.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 dis_show_code.py

Name:              f
Filename:          dis_show_code.py
Argument count:    0
Kw-only arguments: 0
Number of locals:  2
Stack size:        3
Flags:             OPTIMIZED, NEWLOCALS, VARARGS, NOFREE
Constants:
   0: None
Names:
   0: len
   1: print
Variable names:
   0: args
   1: nargs
</pre></div>
</div>
</div>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<p>Classes can be passed to <code class="docutils literal notranslate"><span class="pre">dis()</span></code>, in which case all of the methods
are disassembled in turn.</p>
<div class="literal-block-wrapper with-linenos docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">dis_class.py</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># encoding: utf-8</span>

<span class="kn">import</span> <span class="nn">dis</span>


<span class="k">class</span> <span class="nc">MyObject</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Example for dis.&quot;&quot;&quot;</span>

    <span class="n">CLASS_ATTRIBUTE</span> <span class="o">=</span> <span class="s1">&#39;some value&#39;</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;MyObject(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>


<span class="n">dis</span><span class="o">.</span><span class="n">dis</span><span class="p">(</span><span class="n">MyObject</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<p>The methods are listed in alphabetical order, not the order they
appear in the file.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 dis_class.py

Disassembly of __init__:
 16           0 LOAD_FAST                1 (name)
              2 LOAD_FAST                0 (self)
              4 STORE_ATTR               0 (name)
              6 LOAD_CONST               0 (None)
              8 RETURN_VALUE

Disassembly of __str__:
 13           0 LOAD_CONST               1 (&#39;MyObject({})&#39;)
              2 LOAD_METHOD              0 (format)
              4 LOAD_FAST                0 (self)
              6 LOAD_ATTR                1 (name)
              8 CALL_METHOD              1
             10 RETURN_VALUE
</pre></div>
</div>
</div>
<div class="section" id="source-code">
<h2>Source Code<a class="headerlink" href="#source-code" title="Permalink to this headline">¶</a></h2>
<p>It is often more convenient to work with the source code for a program
than with the code objects themselves. The functions in <code class="docutils literal notranslate"><span class="pre">dis</span></code>
accept string arguments containing source code, and convert them to
code objects before producing the disassembly or other output.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">dis_string.py</span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dis</span>

<span class="n">code</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">my_dict = {&#39;a&#39;: 1}</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Disassembly:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">dis</span><span class="o">.</span><span class="n">dis</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Code details:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">dis</span><span class="o">.</span><span class="n">show_code</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Passing a string lets you save the step of compiling the code and
holding a reference to the results yourself, which is more convenient
in cases when statements outside of a function are being examined.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 dis_string.py

Disassembly:

  2           0 LOAD_CONST               0 (&#39;a&#39;)
              2 LOAD_CONST               1 (1)
              4 BUILD_MAP                1
              6 STORE_NAME               0 (my_dict)
              8 LOAD_CONST               2 (None)
             10 RETURN_VALUE

Code details:

Name:              &lt;module&gt;
Filename:          &lt;disassembly&gt;
Argument count:    0
Kw-only arguments: 0
Number of locals:  0
Stack size:        2
Flags:             NOFREE
Constants:
   0: &#39;a&#39;
   1: 1
   2: None
Names:
   0: my_dict
</pre></div>
</div>
</div>
<div class="section" id="using-disassembly-to-debug">
<h2>Using Disassembly to Debug<a class="headerlink" href="#using-disassembly-to-debug" title="Permalink to this headline">¶</a></h2>
<p>Sometimes when debugging an exception it can be useful to see which
bytecode caused a problem.  There are a couple of ways to disassemble
the code around an error.  The first is by using <code class="docutils literal notranslate"><span class="pre">dis()</span></code> in the
interactive interpreter to report about the last exception.  If no
argument is passed to <code class="docutils literal notranslate"><span class="pre">dis()</span></code>, then it looks for an exception and
shows the disassembly of the top of the stack that caused it.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3
Python 3.5.1 (v3.5.1:37a07cee5969, Dec  5 2015, 21:12:44)
[GCC 4.2.1 (Apple Inc. build 5666) (dot 3)] on darwin
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; import dis
&gt;&gt;&gt; j = 4
&gt;&gt;&gt; i = i + 4
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
NameError: name &#39;i&#39; is not defined
&gt;&gt;&gt; dis.dis()
  1 --&gt;       0 LOAD_NAME                0 (i)
              3 LOAD_CONST               0 (4)
              6 BINARY_ADD
              7 STORE_NAME               0 (i)
             10 LOAD_CONST               1 (None)
             13 RETURN_VALUE
&gt;&gt;&gt;
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">--&gt;</span></code> after the line number indicates the opcode that caused the
error.  There is no <code class="docutils literal notranslate"><span class="pre">i</span></code> variable defined, so the value associated
with the name cannot be loaded onto the stack.</p>
<p>A program can also print the information about an active traceback by
passing it to <code class="docutils literal notranslate"><span class="pre">distb()</span></code> directly.  In this example, there is a
<code class="docutils literal notranslate"><span class="pre">DivideByZero</span></code> exception, but since the formula has two
divisions it may not be clear which part is zero.</p>
<div class="literal-block-wrapper with-linenos docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">dis_traceback.py</span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># encoding: utf-8</span>

<span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">3</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="n">k</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">dis</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">exc_tb</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()</span>
    <span class="n">dis</span><span class="o">.</span><span class="n">distb</span><span class="p">(</span><span class="n">exc_tb</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<p>The error is easy to spot when it is loaded onto the stack in the
disassembled version.  The bad operation is highlighted with the
<code class="docutils literal notranslate"><span class="pre">--&gt;</span></code>, and the previous line pushes the value for <code class="docutils literal notranslate"><span class="pre">j</span></code> onto the
stack.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>    $ python3 dis_traceback.py

      4           0 LOAD_CONST               0 (1)
                  2 STORE_NAME               0 (i)

      5           4 LOAD_CONST               1 (0)
                  6 STORE_NAME               1 (j)

      6           8 LOAD_CONST               2 (3)
                 10 STORE_NAME               2 (k)

      8          12 SETUP_EXCEPT            24 (to 38)

      9          14 LOAD_NAME                2 (k)
                 16 LOAD_NAME                0 (i)
                 18 LOAD_NAME                1 (j)
        --&gt;      20 BINARY_TRUE_DIVIDE
                 22 BINARY_MULTIPLY
                 24 LOAD_NAME                0 (i)
                 26 LOAD_NAME                2 (k)
                 28 BINARY_TRUE_DIVIDE
                 30 BINARY_ADD
                 32 STORE_NAME               3 (result)

...trimmed...
</pre></div>
</div>
</div>
<div class="section" id="performance-analysis-of-loops">
<h2>Performance Analysis of Loops<a class="headerlink" href="#performance-analysis-of-loops" title="Permalink to this headline">¶</a></h2>
<p>Besides debugging errors, <code class="docutils literal notranslate"><span class="pre">dis</span></code> can also help identify
performance issues. Examining the disassembled code is especially
useful with tight loops where the number of Python instructions is low
but they translate to an inefficient set of bytecodes.  The
helpfulness of the disassembly can be seen by examining a few
different implementations of a class, <code class="docutils literal notranslate"><span class="pre">Dictionary</span></code>, that reads
a list of words and groups them by their first letter.</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">dis_test_loop.py</span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dis</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">textwrap</span>
<span class="kn">import</span> <span class="nn">timeit</span>

<span class="n">module_name</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">module</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="n">module_name</span><span class="p">)</span>
<span class="n">Dictionary</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">Dictionary</span>

<span class="n">dis</span><span class="o">.</span><span class="n">dis</span><span class="p">(</span><span class="n">Dictionary</span><span class="o">.</span><span class="n">load_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span>
    <span class="s1">&#39;d = Dictionary(words)&#39;</span><span class="p">,</span>
    <span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    from </span><span class="si">{module_name}</span><span class="s2"> import Dictionary</span>
<span class="s2">    words = [</span>
<span class="s2">        l.strip()</span>
<span class="s2">        for l in open(&#39;/usr/share/dict/words&#39;, &#39;rt&#39;)</span>
<span class="s2">    ]</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">module_name</span><span class="o">=</span><span class="n">module_name</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">iterations</span> <span class="o">=</span> <span class="mi">10</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;TIME: </span><span class="si">{:0.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="n">iterations</span><span class="p">)</span> <span class="o">/</span> <span class="n">iterations</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>The test driver application <code class="docutils literal notranslate"><span class="pre">dis_test_loop.py</span></code> can be used to run
each incarnation of the <code class="docutils literal notranslate"><span class="pre">Dictionary</span></code> class, starting with a
straightforward, but slow, implementation.</p>
<div class="literal-block-wrapper with-linenos docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">dis_slow_loop.py</span><a class="headerlink" href="#id7" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># encoding: utf-8</span>


<span class="k">class</span> <span class="nc">Dictionary</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">by_letter</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">by_letter</span><span class="p">[</span><span class="n">word</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">by_letter</span><span class="p">[</span><span class="n">word</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span><span class="p">]</span>
</pre></div>
</td></tr></table></div>
</div>
<p>Running the test program with this version shows the disassembled
program and the amount of time it takes to run.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 dis_test_loop.py dis_slow_loop

 12           0 SETUP_LOOP              83 (to 86)
              3 LOAD_FAST                1 (words)
              6 GET_ITER
        &gt;&gt;    7 FOR_ITER                75 (to 85)
             10 STORE_FAST               2 (word)

 13          13 SETUP_EXCEPT            28 (to 44)

 14          16 LOAD_FAST                0 (self)
             19 LOAD_ATTR                0 (by_letter)
             22 LOAD_FAST                2 (word)
             25 LOAD_CONST               1 (0)
             28 BINARY_SUBSCR
             29 BINARY_SUBSCR
             30 LOAD_ATTR                1 (append)
             33 LOAD_FAST                2 (word)
             36 CALL_FUNCTION            1 (1 positional, 0
keyword pair)
             39 POP_TOP
             40 POP_BLOCK
             41 JUMP_ABSOLUTE            7

 15     &gt;&gt;   44 DUP_TOP
             45 LOAD_GLOBAL              2 (KeyError)
             48 COMPARE_OP              10 (exception match)
             51 POP_JUMP_IF_FALSE       81
             54 POP_TOP
             55 POP_TOP
             56 POP_TOP

 16          57 LOAD_FAST                2 (word)
             60 BUILD_LIST               1
             63 LOAD_FAST                0 (self)
             66 LOAD_ATTR                0 (by_letter)
             69 LOAD_FAST                2 (word)
             72 LOAD_CONST               1 (0)
             75 BINARY_SUBSCR
             76 STORE_SUBSCR
             77 POP_EXCEPT
             78 JUMP_ABSOLUTE            7
        &gt;&gt;   81 END_FINALLY
             82 JUMP_ABSOLUTE            7
        &gt;&gt;   85 POP_BLOCK
        &gt;&gt;   86 LOAD_CONST               0 (None)
             89 RETURN_VALUE

TIME: 0.0568
</pre></div>
</div>
<p>The previous output shows <code class="docutils literal notranslate"><span class="pre">dis_slow_loop.py</span></code> taking 0.0568 seconds
to load the 235886 words in the copy of <code class="docutils literal notranslate"><span class="pre">/usr/share/dict/words</span></code> on
OS X.  That is not too bad, but the accompanying disassembly shows
that the loop is doing more work than it needs to.  As it enters the
loop in opcode 13, it sets up an exception context
(<code class="docutils literal notranslate"><span class="pre">SETUP_EXCEPT</span></code>).  Then it takes six opcodes to find
<code class="docutils literal notranslate"><span class="pre">self.by_letter[word[0]]</span></code> before appending <code class="docutils literal notranslate"><span class="pre">word</span></code> to the list.  If
there is an exception because <code class="docutils literal notranslate"><span class="pre">word[0]</span></code> is not in the dictionary
yet, the exception handler does all of the same work to determine
<code class="docutils literal notranslate"><span class="pre">word[0]</span></code> (three opcodes) and sets <code class="docutils literal notranslate"><span class="pre">self.by_letter[word[0]]</span></code> to a
new list containing the word.</p>
<p>One technique to eliminate the exception setup is to pre-populate
<code class="docutils literal notranslate"><span class="pre">self.by_letter</span></code> with one list for each letter of the alphabet.
That means the list for the new word should always be found, and the
value can be saved after the lookup.</p>
<div class="literal-block-wrapper with-linenos docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">dis_faster_loop.py</span><a class="headerlink" href="#id8" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># encoding: utf-8</span>

<span class="kn">import</span> <span class="nn">string</span>


<span class="k">class</span> <span class="nc">Dictionary</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">by_letter</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">letter</span><span class="p">:</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">by_letter</span><span class="p">[</span><span class="n">word</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<p>The change cuts the number of opcodes in half, but only shaves the
time down to 0.0567 seconds.  Obviously the exception handling had
some overhead, but not a significant amount.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 dis_test_loop.py dis_faster_loop

 17           0 SETUP_LOOP              38 (to 41)
              3 LOAD_FAST                1 (words)
              6 GET_ITER
        &gt;&gt;    7 FOR_ITER                30 (to 40)
             10 STORE_FAST               2 (word)

 18          13 LOAD_FAST                0 (self)
             16 LOAD_ATTR                0 (by_letter)
             19 LOAD_FAST                2 (word)
             22 LOAD_CONST               1 (0)
             25 BINARY_SUBSCR
             26 BINARY_SUBSCR
             27 LOAD_ATTR                1 (append)
             30 LOAD_FAST                2 (word)
             33 CALL_FUNCTION            1 (1 positional, 0
keyword pair)
             36 POP_TOP
             37 JUMP_ABSOLUTE            7
        &gt;&gt;   40 POP_BLOCK
        &gt;&gt;   41 LOAD_CONST               0 (None)
             44 RETURN_VALUE

TIME: 0.0567
</pre></div>
</div>
<p>The performance can be improved further by moving the lookup for
<code class="docutils literal notranslate"><span class="pre">self.by_letter</span></code> outside of the loop (the value does not change,
after all).</p>
<div class="literal-block-wrapper with-linenos docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">dis_fastest_loop.py</span><a class="headerlink" href="#id9" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># encoding: utf-8</span>

<span class="kn">import</span> <span class="nn">collections</span>


<span class="k">class</span> <span class="nc">Dictionary</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">by_letter</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
        <span class="n">by_letter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">by_letter</span>
        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
            <span class="n">by_letter</span><span class="p">[</span><span class="n">word</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<p>Opcodes 0-6 now find the value of <code class="docutils literal notranslate"><span class="pre">self.by_letter</span></code> and save it as a
local variable <code class="docutils literal notranslate"><span class="pre">by_letter</span></code>.  Using a local variable only takes a
single opcode, instead of two (statement 22 uses <code class="docutils literal notranslate"><span class="pre">LOAD_FAST</span></code> to
place the dictionary onto the stack).  After this change, the run time
is down to 0.0473 seconds.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 dis_test_loop.py dis_fastest_loop

 14           0 LOAD_FAST                0 (self)
              3 LOAD_ATTR                0 (by_letter)
              6 STORE_FAST               2 (by_letter)

 15           9 SETUP_LOOP              35 (to 47)
             12 LOAD_FAST                1 (words)
             15 GET_ITER
        &gt;&gt;   16 FOR_ITER                27 (to 46)
             19 STORE_FAST               3 (word)

 16          22 LOAD_FAST                2 (by_letter)
             25 LOAD_FAST                3 (word)
             28 LOAD_CONST               1 (0)
             31 BINARY_SUBSCR
             32 BINARY_SUBSCR
             33 LOAD_ATTR                1 (append)
             36 LOAD_FAST                3 (word)
             39 CALL_FUNCTION            1 (1 positional, 0
keyword pair)
             42 POP_TOP
             43 JUMP_ABSOLUTE           16
        &gt;&gt;   46 POP_BLOCK
        &gt;&gt;   47 LOAD_CONST               0 (None)
             50 RETURN_VALUE

TIME: 0.0473
</pre></div>
</div>
<p>A further optimization, suggested by Brandon Rhodes, is to eliminate
the Python version of the <code class="docutils literal notranslate"><span class="pre">for</span></code> loop entirely. If
<code class="docutils literal notranslate"><span class="pre">itertools.groupby()</span></code> is used to arrange the input, the iteration
is moved to C.  This is safe because the inputs are known to be
sorted.  If that was not the case, the program would need to sort them
first.</p>
<div class="literal-block-wrapper with-linenos docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">dis_eliminate_loop.py</span><a class="headerlink" href="#id10" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># encoding: utf-8</span>

<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">itertools</span>


<span class="k">class</span> <span class="nc">Dictionary</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">by_letter</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
        <span class="c1"># Arrange by letter</span>
        <span class="n">grouped</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span>
            <span class="n">words</span><span class="p">,</span>
            <span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="c1"># Save arranged sets of words</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">by_letter</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">group</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span> <span class="n">group</span>
            <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span>
        <span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">itertools</span></code> version takes only 0.0332 seconds to run, about
60% of the run time for the original.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>    $ python3 dis_test_loop.py dis_eliminate_loop

     16           0 LOAD_GLOBAL              0 (itertools)
                  3 LOAD_ATTR                1 (groupby)

     17           6 LOAD_FAST                1 (words)
                  9 LOAD_CONST               1 (&#39;key&#39;)

     18          12 LOAD_GLOBAL              2 (operator)
                 15 LOAD_ATTR                3 (itemgetter)
                 18 LOAD_CONST               2 (0)
                 21 CALL_FUNCTION            1 (1 positional, 0
    keyword pair)
                 24 CALL_FUNCTION          257 (1 positional, 1
    keyword pair)
                 27 STORE_FAST               2 (grouped)

     21          30 LOAD_CONST               3 (&lt;code object
    &lt;dictcomp&gt; at 0x101517930, file &quot;.../dis_eliminate_loop.py&quot;,
line 21&gt;)
                 33 LOAD_CONST               4
    (&#39;Dictionary.load_data.&lt;locals&gt;.&lt;dictcomp&gt;&#39;)
                 36 MAKE_FUNCTION            0

     23          39 LOAD_FAST                2 (grouped)
                 42 GET_ITER
                 43 CALL_FUNCTION            1 (1 positional, 0
    keyword pair)
                 46 LOAD_FAST                0 (self)
                 49 STORE_ATTR               4 (by_letter)
                 52 LOAD_CONST               0 (None)
                 55 RETURN_VALUE

    TIME: 0.0332
</pre></div>
</div>
</div>
<div class="section" id="compiler-optimizations">
<h2>Compiler Optimizations<a class="headerlink" href="#compiler-optimizations" title="Permalink to this headline">¶</a></h2>
<p>Disassembling compiled source also exposes some of the optimizations
made by the compiler.  For example, literal expressions are folded
during compilation, when possible.</p>
<div class="literal-block-wrapper with-linenos docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text">dis_constant_folding.py</span><a class="headerlink" href="#id11" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># encoding: utf-8</span>

<span class="c1"># Folded</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span>
<span class="n">f</span> <span class="o">=</span> <span class="mf">3.4</span> <span class="o">*</span> <span class="mf">5.6</span>
<span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;Hello,&#39;</span> <span class="o">+</span> <span class="s1">&#39; World!&#39;</span>

<span class="c1"># Not folded</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">4</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">f</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;Fantastic!&#39;</span>
</pre></div>
</td></tr></table></div>
</div>
<p>None of the values in the expressions on lines 5-7 can change the way
the operation is performed, so the result of the expressions can be
computed at compilation time and collapsed into single
<code class="docutils literal notranslate"><span class="pre">LOAD_CONST</span></code> instructions.  That is not true about lines
10-12. Because a variable is involved in those expressions, and the
variable might refer to an object that overloads the operator
involved, the evaluation has to be delayed to runtime.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 -m dis dis_constant_folding.py

  5           0 LOAD_CONST               0 (3)
              2 STORE_NAME               0 (i)

  6           4 LOAD_CONST               1 (19.04)
              6 STORE_NAME               1 (f)

  7           8 LOAD_CONST               2 (&#39;Hello, World!&#39;)
             10 STORE_NAME               2 (s)

 10          12 LOAD_NAME                0 (i)
             14 LOAD_CONST               0 (3)
             16 BINARY_MULTIPLY
             18 LOAD_CONST               3 (4)
             20 BINARY_MULTIPLY
             22 STORE_NAME               3 (I)

 11          24 LOAD_NAME                1 (f)
             26 LOAD_CONST               4 (2)
             28 BINARY_TRUE_DIVIDE
             30 LOAD_CONST               0 (3)
             32 BINARY_TRUE_DIVIDE
             34 STORE_NAME               4 (F)

 12          36 LOAD_NAME                2 (s)
             38 LOAD_CONST               5 (&#39;\n&#39;)
             40 BINARY_ADD
             42 LOAD_CONST               6 (&#39;Fantastic!&#39;)
             44 BINARY_ADD
             46 STORE_NAME               5 (S)
             48 LOAD_CONST               7 (None)
             50 RETURN_VALUE
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference external" href="https://docs.python.org/3.7/library/dis.html">Standard library documentation for dis</a> – Includes the list of <a class="reference external" href="https://docs.python.org/3.5/library/dis.html#python-bytecode-instructions">bytecode instructions</a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">Include/opcode.h</span></code> – The source code for the CPython
interpreter defines the byte codes in <code class="docutils literal notranslate"><span class="pre">opcode.h</span></code>.</li>
<li><em>Python Essential Reference</em>, 4th Edition, David M. Beazley –
<a class="reference external" href="http://www.informit.com/store/product.aspx?isbn=0672329786">http://www.informit.com/store/product.aspx?isbn=0672329786</a></li>
<li><a class="reference external" href="http://thomas.apestaart.org/log/?p=927">thomas.apestaart.org “Python Disassembly”</a> – A short discussion
of the difference between storing values in a dictionary between
Python 2.5 and 2.6.</li>
<li><a class="reference external" href="http://stackoverflow.com/questions/869229/why-is-looping-over-range-in-python-faster-than-using-a-while-loop">Why is looping over range() in Python faster than using a while
loop?</a>
– A discussion on StackOverflow.com comparing 2 looping
examples via their disassembled bytecodes.</li>
<li><a class="reference external" href="http://code.activestate.com/recipes/277940/">Decorator for binding constants at compile time</a> – Python
Cookbook recipe by Raymond Hettinger and Skip Montanaro with a
function decorator that re-writes the bytecodes for a function
to insert global constants to avoid runtime name lookups.</li>
</ul>
</div>
</div>
</div>



        <div id="footer-nav">
<a id="prev-link" href="../abc/index.html"
   title="previous chapter"><i class="fa fa-arrow-circle-left"></i> abc — Abstract Base Classes</a>
<a id="next-link" href="../inspect/index.html"
   title="next chapter">inspect — Inspect Live Objects <i class="fa fa-arrow-circle-right"></i></a>
        </div>

        </div>
      </div>

      <div class="pure-u-1-4">
        <div class="sidebar-wrapper">
          <div class="sidebar">
<div id="sidebar-toc">
  <h5>Quick Links</h5>
  <ul>
    
    <li><a href="#basic-disassembly"><i class="fa fa-caret-right"></i>Basic Disassembly</a></li>
    
    <li><a href="#disassembling-functions"><i class="fa fa-caret-right"></i>Disassembling Functions</a></li>
    
    <li><a href="#classes"><i class="fa fa-caret-right"></i>Classes</a></li>
    
    <li><a href="#source-code"><i class="fa fa-caret-right"></i>Source Code</a></li>
    
    <li><a href="#using-disassembly-to-debug"><i class="fa fa-caret-right"></i>Using Disassembly to Debug</a></li>
    
    <li><a href="#performance-analysis-of-loops"><i class="fa fa-caret-right"></i>Performance Analysis of Loops</a></li>
    
    <li><a href="#compiler-optimizations"><i class="fa fa-caret-right"></i>Compiler Optimizations</a></li>
    
  </ul>
</div>

          </div>
          <div class="sidebar"><div id="sidebar-last-updated">
  This page was last updated 2018-12-09.
</div>

          </div>
          <div class="sidebar">
<div id="sidebar-nav">
  <h5>Navigation</h5>
  <ul>
    <li><a href="../abc/index.html"
           title="previous chapter"><i class="fa fa-arrow-circle-left"></i>abc — Abstract Base Classes</a></li>
    <li><a href="../inspect/index.html"
           title="next chapter"><i class="fa fa-arrow-circle-right"></i>inspect — Inspect Live Objects</a></li>
  </ul>
</div>
          </div>
          <div class="sidebar"><div id="sidebar-book"><a target="new" href="https://doughellmann.com/books/the-python-3-standard-library-by-example/"><img src="../_static/book-cover-image-med.jpg"><br>Get the book</a></div>
          </div>
          <div class="sidebar"><div id="sidebar-example-disclaimer">
<p>The output from all the example programs
from PyMOTW-3 has been generated with Python 3.7.9, unless
otherwise noted. Some of the features described here may not be
available in earlier versions of Python.</p>
<p>Looking for <a href="/2/">examples for Python 2</a>?</p>
</div>
          </div>

        </div>
      </div>

    </div>

    <div class="pure-g-r" id="footer">

      <div class="pure-u-1-3">
        <div class="footer-list">
            <h4>This Site</h4>
            <ul>
              <li><a href="../py-modindex.html"><i class="fa fa-list fa-lg"></i> Module Index</a></li>
              <li><a href="../genindex.html"><i class="fa fa-italic fa-lg"></i> Index</a></li>
            </ul>
        </div>
      </div><div class="pure-u-1-3">
          <div class="footer-content">
            <div class="socialmedia">
              <a class="sociallink" href="../index.html"
       title="Home">
      <i class="fa fa-home fa-lg"></i></a>
              <a class="sociallink" href="../about.html"
       title="About">
      <i class="fa fa-user fa-lg"></i></a>
              <a class="sociallink" href="http://www.twitter.com/pymotw"
       title="Twitter">
      <i class="fa fa-twitter fa-lg"></i></a>
              <a class="sociallink" href="https://feeds.feedburner.com/PyMOTW"
       title="Subscribe via RSS">
      <i class="fa fa-rss-square fa-lg"></i></a>
              <a class="sociallink" href="http://feedburner.google.com/fb/a/mailverify?uri=PyMOTW&amp;loc=en_US"
       title="Subscribe via Email">
      <i class="fa fa-envelope fa-lg"></i></a>
            </div>

            <div class="copyright">
              <a rel="author" href="../about.html">&copy; Copyright 2021, Doug Hellmann</a>
            </div>

            <div class="cc"><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.en_US" rel="license"><img alt="Creative Commons License BY-NC-SA" style="border-width:0; align: center;" width="88" height="31" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAAAfCAMAAABUFvrSAAAABGdBTUEAALGOfPtRkwAAAf5QTFRF////////////AAAADQwNDQ4NDg4OEBAQGRkZGxsbHxscICAgIx8gJCQkKCUmKCgoKCkoKSkpKSopKicnKioqLS0tMDAwMS0uMjExMjMxNTY1Pj8+Pzc5Pzs8QEBAQ0RDUFBQUFFQWldYXV5dYGBgY19haGVmbmxscHBwcHJvdXJzdnN0eHV2eXx5en15fH98fX98fnt8f4F+gICAgoWChIGChIWEhIaEh4aHiYyJjIqLjoeLj4+PkY+PkZORkZSRk5iTlZmUlpmWmJaXmpiZnp2dnqCdn5aan5+fn6Oeoqaho6Gho6ijpqqmq7GqrKurrLKrrbOsrrOtrrStr6+vr7Kvr7Sur7WusLOvsLWvsLavsbewsrexsrixs7iytLmztLqztbW1tbq0tru1t7y2uL23ub64ub65urm5ur+5ur+6u8C6u8C7vMC8vMG7vMG8vcK8vcK9vsK9vsO+v7+/v8O+v8S+wMS/wMW/wMXAwcXAwsfCw8fCw8jDxMfDxMjDxMnExcnExcnFxsrFxsrGx8vHyMfHyMzHyMzIycjIyc3Iyc3Jys3Jy8rLy87Ky8/Ky8/LzM/LzNDLzNDMzdDMzdHMzdHNztHNztLOz8/Pz9PP0NPP0NTQ0dTQ0dTR0tXR0tXS09bS1tXV39/f4N/g4+Pj6Ofn7+/v8fHx////rrSdFQAAAAN0Uk5TAAoO5yEBUwAAA+FJREFUSMe1lo9301QUx6uXUmaf0qJ26iTrRoVinUzjQNR1gAyH6Lqx6XTDoVvXbU7qhA5m7CgYWaTDlLa6AiFsba3t+y+9Sdr8OvVMi7zTnLTf5H7ee9/73n11PA1PpDkcADPRWPwKt8YLG2I2n89m7gh8iluJz0dnpqe+HBsdHRn+7w3JyF1cvpbk05mCJG8Xi9uPpMLdNJ9cXV5UyBNjoyMtkR2A3B9Tt8SCfLTTqUzC2XlMvpcRbnA/IPmryYnzoyM9XuWBt8eI21FBcAy5Qk4KtxkGtQ1I+fRNbnk+evHC5NhJDwATDDIAnhNa1ImdFQTHr6WEvNyFPFeATSTYgAu/dl3/I31jNR6bnZ76eDf4yxRb2Q+71aiz/0JB8JXkrZzCdbFVqrUhRHuu54XkytLczAUvBFADUB6ARwnyqEp/t02prK9XdAXBHC9KyPWVqd6qPhyzlOG55dhsL/hLDTD1A3rYAy+dRu6eXaGKruA75wi2hbqigNd+LYSRW6XUSh64l05dXYruA1OPZfAOD3vhObL/ILDvQkRXynSdvPpaiJB+TVHAfEZuA9d9amlVF7TJd3nu+xgwyu8AqNOnDGAM8/obOLhQpWQotPYReZ/SQdKuKQpY2DwKwFJbGwI4VhCSlxchSFUnNC+CCgaV9RAKoZKh1J4le9FmQv5SFQW88aATXGhEws8wrHb7AANc0CndQS+ag5ERaieke0FXvnkxoYL/1MGi7FSmmVBXMDOu3gLK5J2PMjdXv2tmBX6pDdKSkq39DWXh3G1KI4QYVmS3AHCIPnCXE+4hHy6PcfeQ6sV2lufiL2jJ0wasp4p2k/Z2CEXeeqahDBLS1/c8+dBIXq4IkFAiWQ1QtxtnUMz/wsXfBj+1LzdUKn17dvXXzEqfMoFDNWO57QCe22dskKB5g7zXbVN+i0RKumKxonrfzaIVys2wYu7TVrd0PXn1rOnJC4JTFjF5c19/gnXLFwj6jJJz1rOjoi63LnBRfbmNM+qNunG5baSufhu9OPX5my2VTWEzrHrRbIP8dHl+dnpyrIVDBME/q1u6/E9bGmt9i2AsQmeaFaFwIb22soSlfuL8SEtgOCJKB5BsKkNltWyK7zzWMY3X4exDc6GvsljoX5FzR+BxwdCbf3jAdjTJv5/S39H2B2iXpmgXpWB7iVrB0JuVzpgP07CUO2WKqX+oiVL/benKImhgOIzHf7hx/A/IBdHsQ6Nsmruilo4afVFqB8PLn2U2H8hbxeKWjH9YvuiwxNiMaNhALZptCg5d7zh+Sczmclnx0vEOax6ajdjucSMPTcD/97/Cp54Q929ZZbgcR3o0hAAAAABJRU5ErkJggg=="/></a>
            </div>

          </div></div><div class="pure-u-1-3">
          <div class="footer-list">
            <h4>Other Writing</h4>
            <ul>
              <li><a href="https://doughellmann.com/"><i class="fa fa-pencil fa-lg"></i> Blog</a></li>
              <li><a href="https://doughellmann.com/books/the-python-3-standard-library-by-example/"><i class="fa fa-book fa-lg"></i> The Python Standard Library By Example</a></li>
            </ul>
          </div>
        </div><script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-38546875-3', 'pymotw.com');
  ga('send', 'pageview');
</script>

  </body>
</html>