<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>pkgutil — Package Utilities &mdash; PyMOTW 3</title>

    <link rel="stylesheet" href="../_static/pure-min.css" type="text/css">
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/font-awesome/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pymotw.css" type="text/css">

    <link rel="shortcut icon" type="image/png" href="../_static/favicon.png">

    <link rel="alternate" type="application/atom+xml"
          title="Doug Hellmann"
          href="https://feeds.feedburner.com/DougHellmann" />
    <link rel="alternate" type="application/atom+xml"
          title="PyMOTW Updates"
          href="https://feeds.feedburner.com/PyMOTW" />

    <meta name="verify-v1" content="5saTcOa2HLac4V85yUg3SARfun1PqT5Upu7IR/6fpv4="/>

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@pymotw" />
    <meta name="twitter:title" content="pkgutil — Package Utilities" />
    <meta name="twitter:image" content="https://pymotw.com/3/_static/logo-large.png" />

  </head>
  <body>

    <div class="pure-menu pure-menu-open pure-menu-horizontal" id="site-menu">
      <a class="pure-menu-heading" href="../index.html"><img src="../_static/logo.png"> PyMOTW-3</a>

      <ul id="top-menu">
        <li class="pure-menu-selected"><a href="../py-modindex.html"><i class="fa fa-list fa-lg"></i> Module Index</a></li>
        <li class="pure-menu-selected"><a href="../genindex.html"><i class="fa fa-italic fa-lg"></i> Index</a></li>
        <li class="pure-menu-selected"><a class="sociallink" href="http://www.twitter.com/pymotw"
       title="Twitter">
      <i class="fa fa-twitter fa-lg"></i></a></a>
        <li class="pure-menu-selected"><a class="sociallink" href="https://feeds.feedburner.com/PyMOTW"
       title="Subscribe via RSS">
      <i class="fa fa-rss-square fa-lg"></i></a></li>
      </ul>

    </div>

    <div class="pure-menu pure-menu-open pure-menu-vertical" id="breadcrumbs-menu">
      
      <ul id="breadcrumbs">
        <li class="pure-menu-selected"><a href="../importing.html"><i class="fa fa-arrow-circle-up"></i> Modules and Packages</a></li>
      </ul>
    </div>

    <div class="pure-g-r" id="content-container">

      <div class="pure-u-3-4">
        <div class="content">
          
  <div class="section" id="module-pkgutil">
<span id="pkgutil-package-utilities"></span><h1>pkgutil — Package Utilities<a class="headerlink" href="#module-pkgutil" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Add to the module search path for a specific package and
work with resources included in a package.</td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal notranslate"><span class="pre">pkgutil</span></code> module includes functions for changing the import
rules for Python packages and for loading non-code resources from
files distributed within a package.</p>
<div class="section" id="package-import-paths">
<h2>Package Import Paths<a class="headerlink" href="#package-import-paths" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">extend_path()</span></code> function is used to modify the search path and
change the way sub-modules are imported from within a package so that
several different directories can be combined as though they are one.
This can be used to override installed versions of packages with
development versions, or to combine platform-specific and shared
modules into a single package namespace.</p>
<p>The most common way to call <code class="docutils literal notranslate"><span class="pre">extend_path()</span></code> is by adding two
lines to the <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> inside the package.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import pkgutil
__path__ = pkgutil.extend_path(__path__, __name__)
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">extend_path()</span></code> scans <code class="docutils literal notranslate"><span class="pre">sys.path</span></code> for directories that include a
subdirectory named for the package given as the second argument.  The
list of directories is combined with the path value passed as the
first argument and returned as a single list, suitable for use as the
package import path.</p>
<p>An example package called <code class="xref py py-mod docutils literal notranslate"><span class="pre">demopkg</span></code> includes two files,
<code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> and <code class="docutils literal notranslate"><span class="pre">shared.py</span></code>.  The <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file in
<code class="docutils literal notranslate"><span class="pre">demopkg1</span></code> contains <code class="docutils literal notranslate"><span class="pre">print</span></code> statements to show the search
path before and after it is modified, to highlight the difference.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">demopkg1/__init__.py</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pkgutil</span>
<span class="kn">import</span> <span class="nn">pprint</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;demopkg1.__path__ before:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">__path__</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">__path__</span> <span class="o">=</span> <span class="n">pkgutil</span><span class="o">.</span><span class="n">extend_path</span><span class="p">(</span><span class="n">__path__</span><span class="p">,</span> <span class="vm">__name__</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;demopkg1.__path__ after:&#39;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">__path__</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">extension</span></code> directory, with add-on features for <code class="xref py py-mod docutils literal notranslate"><span class="pre">demopkg</span></code>,
contains three more source files. There is an <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> at each
directory level, and a <code class="docutils literal notranslate"><span class="pre">not_shared.py</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ find extension -name &#39;*.py&#39;

extension/__init__.py
extension/demopkg1/__init__.py
extension/demopkg1/not_shared.py
</pre></div>
</div>
<p>This simple test program imports the <code class="xref py py-mod docutils literal notranslate"><span class="pre">demopkg1</span></code> package.</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">pkgutil_extend_path.py</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">demopkg1</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;demopkg1           :&#39;</span><span class="p">,</span> <span class="n">demopkg1</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">demopkg1.shared</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;demopkg1.shared    : Not found (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;demopkg1.shared    :&#39;</span><span class="p">,</span> <span class="n">demopkg1</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">demopkg1.not_shared</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;demopkg1.not_shared: Not found (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;demopkg1.not_shared:&#39;</span><span class="p">,</span> <span class="n">demopkg1</span><span class="o">.</span><span class="n">not_shared</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>When this test program is run directly from the command line, the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">not_shared</span></code> module is not found.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The full file system paths in these examples have been shortened to
emphasize the parts that change.</p>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 pkgutil_extend_path.py

demopkg1.__path__ before:
[&#39;.../demopkg1&#39;]

demopkg1.__path__ after:
[&#39;.../demopkg1&#39;]

demopkg1           : .../demopkg1/__init__.py
demopkg1.shared    : .../demopkg1/shared.py
demopkg1.not_shared: Not found (No module named &#39;demopkg1.not_sh
ared&#39;)
</pre></div>
</div>
<p>However, if the <code class="docutils literal notranslate"><span class="pre">extension</span></code> directory is added to the
<code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code> and the program is run again, different results are
produced.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ PYTHONPATH=extension python3 pkgutil_extend_path.py

demopkg1.__path__ before:
[&#39;.../demopkg1&#39;]

demopkg1.__path__ after:
[&#39;.../demopkg1&#39;,
 &#39;.../extension/demopkg1&#39;]

demopkg1           : .../demopkg1/__init__.py
demopkg1.shared    : .../demopkg1/shared.py
demopkg1.not_shared: .../extension/demopkg1/not_shared.py
</pre></div>
</div>
<p>The version of <code class="xref py py-mod docutils literal notranslate"><span class="pre">demopkg1</span></code> inside the <code class="docutils literal notranslate"><span class="pre">extension</span></code> directory has
been added to the search path, so the <code class="xref py py-mod docutils literal notranslate"><span class="pre">not_shared</span></code> module is
found there.</p>
<p>Extending the path in this manner is useful for combining
platform-specific versions of packages with common packages,
especially if the platform-specific versions include C extension
modules.</p>
</div>
<div class="section" id="development-versions-of-packages">
<h2>Development Versions of Packages<a class="headerlink" href="#development-versions-of-packages" title="Permalink to this headline">¶</a></h2>
<p>While developing enhancements to a project, it is common to need to
test changes to an installed package. Replacing the installed copy
with a development version may be a bad idea, since it is not
necessarily correct and other tools on the system are likely to depend
on the installed package.</p>
<p>A completely separate copy of the package could be configured in a
development environment using <code class="docutils literal notranslate"><span class="pre">virtualenv</span></code> or <a class="reference internal" href="../venv/index.html#module-venv" title="venv: Create isolated installation and execution contexts."><code class="xref py py-mod docutils literal notranslate"><span class="pre">venv</span></code></a>,
but for small modifications the overhead of setting up a virtual
environment with all of the dependencies may be excessive.</p>
<p>Another option is to use <code class="docutils literal notranslate"><span class="pre">pkgutil</span></code> to modify the module search
path for modules that belong to the package under development. In this
case, however, the path must be reversed so development version
overrides the installed version.</p>
<p>Given a package <code class="xref py py-mod docutils literal notranslate"><span class="pre">demopkg2</span></code> containing an <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> and
<code class="docutils literal notranslate"><span class="pre">overloaded.py</span></code>, with the function under development located in
<code class="docutils literal notranslate"><span class="pre">demopkg2/overloaded.py</span></code>. The installed version contains</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">demopkg2/overloaded.py</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">func</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;This is the installed version of func().&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>and <code class="docutils literal notranslate"><span class="pre">demopkg2/__init__.py</span></code> contains</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">demopkg2/__init__.py</span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pkgutil</span>

<span class="n">__path__</span> <span class="o">=</span> <span class="n">pkgutil</span><span class="o">.</span><span class="n">extend_path</span><span class="p">(</span><span class="n">__path__</span><span class="p">,</span> <span class="vm">__name__</span><span class="p">)</span>
<span class="n">__path__</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">reverse()</span></code> is used to ensure that any directories added to the
search path by <code class="docutils literal notranslate"><span class="pre">pkgutil</span></code> are scanned for imports <em>before</em> the
default location.</p>
<p>This program imports <code class="xref py py-mod docutils literal notranslate"><span class="pre">demopkg2.overloaded</span></code> and calls <code class="docutils literal notranslate"><span class="pre">func()</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">pkgutil_devel.py</span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">demopkg2</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;demopkg2           :&#39;</span><span class="p">,</span> <span class="n">demopkg2</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">demopkg2.overloaded</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;demopkg2.overloaded:&#39;</span><span class="p">,</span> <span class="n">demopkg2</span><span class="o">.</span><span class="n">overloaded</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span>

<span class="nb">print</span><span class="p">()</span>
<span class="n">demopkg2</span><span class="o">.</span><span class="n">overloaded</span><span class="o">.</span><span class="n">func</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Running it without any special path treatment produces output from the
installed version of <code class="docutils literal notranslate"><span class="pre">func()</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 pkgutil_devel.py

demopkg2           : .../demopkg2/__init__.py
demopkg2.overloaded: .../demopkg2/overloaded.py

This is the installed version of func().
</pre></div>
</div>
<p>A development directory containing</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ find develop/demopkg2 -name &#39;*.py&#39;

develop/demopkg2/__init__.py
develop/demopkg2/overloaded.py
</pre></div>
</div>
<p>and a modified version of <code class="xref py py-mod docutils literal notranslate"><span class="pre">overloaded</span></code></p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">develop/demopkg2/overloaded.py</span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">func</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;This is the development version of func().&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>will be loaded when the test program is run with the <code class="docutils literal notranslate"><span class="pre">develop</span></code>
directory in the search path.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ PYTHONPATH=develop python3 pkgutil_devel.py

demopkg2           : .../demopkg2/__init__.py
demopkg2.overloaded: .../develop/demopkg2/overloaded.py

This is the development version of func().
</pre></div>
</div>
</div>
<div class="section" id="managing-paths-with-pkg-files">
<h2>Managing Paths with PKG Files<a class="headerlink" href="#managing-paths-with-pkg-files" title="Permalink to this headline">¶</a></h2>
<p>The first example illustrated how to extend the search path using
extra directories included in the <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code>. It is also
possible to add to the search path using <code class="docutils literal notranslate"><span class="pre">*.pkg</span></code> files containing
directory names. PKG files are similar to the PTH files used by the
<a class="reference internal" href="../site/index.html#module-site" title="site: Site-wide configuration"><code class="xref py py-mod docutils literal notranslate"><span class="pre">site</span></code></a> module. They can contain directory names, one per line, to
be added to the search path for the package.</p>
<p>Another way to structure the platform-specific portions of the
application from the first example is to use a separate directory for
each operating system, and include a <code class="docutils literal notranslate"><span class="pre">.pkg</span></code> file to extend the
search path.</p>
<p>This example uses the same <code class="xref py py-mod docutils literal notranslate"><span class="pre">demopkg1</span></code> files, and also includes
the following files.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ find os_* -type f

os_one/demopkg1/__init__.py
os_one/demopkg1/not_shared.py
os_one/demopkg1.pkg
os_two/demopkg1/__init__.py
os_two/demopkg1/not_shared.py
os_two/demopkg1.pkg
</pre></div>
</div>
<p>The PKG files are named <code class="docutils literal notranslate"><span class="pre">demopkg1.pkg</span></code> to match the package
being extended.  They both contain one line.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">demopkg</span>
</pre></div>
</div>
<p>This demo program shows the version of the module being imported.</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">pkgutil_os_specific.py</span><a class="headerlink" href="#id7" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">demopkg1</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;demopkg1:&#39;</span><span class="p">,</span> <span class="n">demopkg1</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">demopkg1.shared</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;demopkg1.shared:&#39;</span><span class="p">,</span> <span class="n">demopkg1</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">demopkg1.not_shared</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;demopkg1.not_shared:&#39;</span><span class="p">,</span> <span class="n">demopkg1</span><span class="o">.</span><span class="n">not_shared</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>A simple wrapper script can be used to switch between the two
packages.</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">with_os.sh</span><a class="headerlink" href="#id8" title="Permalink to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="nb">export</span> <span class="nv">PYTHONPATH</span><span class="o">=</span>os_<span class="si">${</span><span class="nv">1</span><span class="si">}</span>
<span class="nb">echo</span> <span class="s2">&quot;PYTHONPATH=</span><span class="nv">$PYTHONPATH</span><span class="s2">&quot;</span>
<span class="nb">echo</span>

python3 pkgutil_os_specific.py
</pre></div>
</div>
</div>
<p>When run with <code class="docutils literal notranslate"><span class="pre">&quot;one&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;two&quot;</span></code> as the arguments, the path is
adjusted.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ ./with_os.sh one

PYTHONPATH=os_one

demopkg1.__path__ before:
[&#39;.../demopkg1&#39;]

demopkg1.__path__ after:
[&#39;.../demopkg1&#39;,
 &#39;.../os_one/demopkg1&#39;,
 &#39;demopkg&#39;]

demopkg1: .../demopkg1/__init__.py
demopkg1.shared: .../demopkg1/shared.py
demopkg1.not_shared: .../os_one/demopkg1/not_shared.py

$ ./with_os.sh two

PYTHONPATH=os_two

demopkg1.__path__ before:
[&#39;.../demopkg1&#39;]

demopkg1.__path__ after:
[&#39;.../demopkg1&#39;,
 &#39;.../os_two/demopkg1&#39;,
 &#39;demopkg&#39;]

demopkg1: .../demopkg1/__init__.py
demopkg1.shared: .../demopkg1/shared.py
demopkg1.not_shared: .../os_two/demopkg1/not_shared.py
</pre></div>
</div>
<p>PKG files can appear anywhere in the normal search path, so a
single PKG file in the current working directory could also be
used to include a development tree.</p>
</div>
<div class="section" id="nested-packages">
<h2>Nested Packages<a class="headerlink" href="#nested-packages" title="Permalink to this headline">¶</a></h2>
<p>For nested packages, it is only necessary to modify the path of the top-level
package. For example, with this directory structure</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ find nested -name &#39;*.py&#39;

nested/__init__.py
nested/second/__init__.py
nested/second/deep.py
nested/shallow.py
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">nested/__init__.py</span></code> contains</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">nested/__init__.py</span><a class="headerlink" href="#id9" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pkgutil</span>

<span class="n">__path__</span> <span class="o">=</span> <span class="n">pkgutil</span><span class="o">.</span><span class="n">extend_path</span><span class="p">(</span><span class="n">__path__</span><span class="p">,</span> <span class="vm">__name__</span><span class="p">)</span>
<span class="n">__path__</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>and a development tree like</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ find develop/nested -name &#39;*.py&#39;

develop/nested/__init__.py
develop/nested/second/__init__.py
develop/nested/second/deep.py
develop/nested/shallow.py
</pre></div>
</div>
<p>Both the <code class="xref py py-mod docutils literal notranslate"><span class="pre">shallow</span></code> and <code class="xref py py-mod docutils literal notranslate"><span class="pre">deep</span></code> modules contain a simple
function to print out a message indicating whether or not they come
from the installed or development version.</p>
<p>This test program exercises the new packages.</p>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">pkgutil_nested.py</span><a class="headerlink" href="#id10" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nested</span>

<span class="kn">import</span> <span class="nn">nested.shallow</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nested.shallow:&#39;</span><span class="p">,</span> <span class="n">nested</span><span class="o">.</span><span class="n">shallow</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">nested</span><span class="o">.</span><span class="n">shallow</span><span class="o">.</span><span class="n">func</span><span class="p">()</span>

<span class="nb">print</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">nested.second.deep</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nested.second.deep:&#39;</span><span class="p">,</span> <span class="n">nested</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">deep</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">nested</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">deep</span><span class="o">.</span><span class="n">func</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">pkgutil_nested.py</span></code> is run without any path manipulation, the
installed version of both modules are used.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 pkgutil_nested.py

nested.shallow: .../nested/shallow.py
This func() comes from the installed version of nested.shallow

nested.second.deep: .../nested/second/deep.py
This func() comes from the installed version of nested.second.de
ep
</pre></div>
</div>
<p>When the <code class="docutils literal notranslate"><span class="pre">develop</span></code> directory is added to the path, the development
version of both functions override the installed versions.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ PYTHONPATH=develop python3 pkgutil_nested.py

nested.shallow: .../develop/nested/shallow.py
This func() comes from the development version of nested.shallow

nested.second.deep: .../develop/nested/second/deep.py
This func() comes from the development version of nested.second.
deep
</pre></div>
</div>
</div>
<div class="section" id="package-data">
<h2>Package Data<a class="headerlink" href="#package-data" title="Permalink to this headline">¶</a></h2>
<p>In addition to code, Python packages can contain data files such as
templates, default configuration files, images, and other supporting
files used by the code in the package.  The <code class="docutils literal notranslate"><span class="pre">get_data()</span></code> function
gives access to the data in the files in a format-agnostic way, so it
does not matter if the package is distributed as an EGG, part of a
frozen binary, or regular files on the file system.</p>
<p>With a package <code class="xref py py-mod docutils literal notranslate"><span class="pre">pkgwithdata</span></code> containing a <code class="docutils literal notranslate"><span class="pre">templates</span></code> directory</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ find pkgwithdata -type f

pkgwithdata/__init__.py
pkgwithdata/templates/base.html
</pre></div>
</div>
<p>The file <code class="docutils literal notranslate"><span class="pre">pkgwithdata/templates/base.html</span></code> contains a simple HTML
template.</p>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text">pkgwithdata/templates/base.html</span><a class="headerlink" href="#id11" title="Permalink to this code">¶</a></div>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML//EN&quot;&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>PyMOTW Template<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Example Template<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>This is a sample data file.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
<p>This program uses <code class="docutils literal notranslate"><span class="pre">get_data()</span></code> to retrieve the template contents
and print them out.</p>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text">pkgutil_get_data.py</span><a class="headerlink" href="#id12" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pkgutil</span>

<span class="n">template</span> <span class="o">=</span> <span class="n">pkgutil</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s1">&#39;pkgwithdata&#39;</span><span class="p">,</span> <span class="s1">&#39;templates/base.html&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>The arguments to <code class="docutils literal notranslate"><span class="pre">get_data()</span></code> are the dotted name of the package,
and a filename relative to the top of the package.  The return value
is a byte sequence, so it is decoded from UTF-8 before being printed.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 pkgutil_get_data.py

&lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML//EN&quot;&gt;
&lt;html&gt; &lt;head&gt;
&lt;title&gt;PyMOTW Template&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;h1&gt;Example Template&lt;/h1&gt;

&lt;p&gt;This is a sample data file.&lt;/p&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">get_data()</span></code> is distribution format-agnostic because it uses the
import hooks defined in PEP 302 to access the package contents.
Any loader that provides the hooks can be used, including the ZIP
archive importer in <a class="reference internal" href="../zipfile/index.html#module-zipfile" title="zipfile: ZIP archive access"><code class="xref py py-mod docutils literal notranslate"><span class="pre">zipfile</span></code></a>.</p>
<div class="literal-block-wrapper docutils container" id="id13">
<div class="code-block-caption"><span class="caption-text">pkgutil_get_data_zip.py</span><a class="headerlink" href="#id13" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pkgutil</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># Create a ZIP file with code from the current directory</span>
<span class="c1"># and the template using a name that does not appear on the</span>
<span class="c1"># local filesystem.</span>
<span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">PyZipFile</span><span class="p">(</span><span class="s1">&#39;pkgwithdatainzip.zip&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zf</span><span class="p">:</span>
    <span class="n">zf</span><span class="o">.</span><span class="n">writepy</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">zf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;pkgwithdata/templates/base.html&#39;</span><span class="p">,</span>
             <span class="s1">&#39;pkgwithdata/templates/fromzip.html&#39;</span><span class="p">,</span>
             <span class="p">)</span>

<span class="c1"># Add the ZIP file to the import path.</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;pkgwithdatainzip.zip&#39;</span><span class="p">)</span>

<span class="c1"># Import pkgwithdata to show that it comes from the ZIP archive.</span>
<span class="kn">import</span> <span class="nn">pkgwithdata</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Loading pkgwithdata from&#39;</span><span class="p">,</span> <span class="n">pkgwithdata</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span>

<span class="c1"># Print the template body</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Template:&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pkgutil</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s1">&#39;pkgwithdata&#39;</span><span class="p">,</span> <span class="s1">&#39;templates/fromzip.html&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>This example uses <code class="docutils literal notranslate"><span class="pre">PyZipFile.writepy()</span></code> to create a ZIP archive
containing a copy of the <code class="xref py py-mod docutils literal notranslate"><span class="pre">pkgwithdata</span></code> package, including a
renamed version of the template file.  It then adds the ZIP archive to
the import path before using <code class="docutils literal notranslate"><span class="pre">pkgutil</span></code> to load the template and
print it.  Refer to the discussion of <a class="reference internal" href="../zipfile/index.html#module-zipfile" title="zipfile: ZIP archive access"><code class="xref py py-mod docutils literal notranslate"><span class="pre">zipfile</span></code></a> for more details
about using <code class="docutils literal notranslate"><span class="pre">writepy()</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 pkgutil_get_data_zip.py

Loading pkgwithdata from
pkgwithdatainzip.zip/pkgwithdata/__init__.pyc

Template:
&lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML//EN&quot;&gt;
&lt;html&gt; &lt;head&gt;
&lt;title&gt;PyMOTW Template&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;h1&gt;Example Template&lt;/h1&gt;

&lt;p&gt;This is a sample data file.&lt;/p&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference external" href="https://docs.python.org/3.7/library/pkgutil.html">Standard library documentation for pkgutil</a></li>
<li><a class="reference external" href="http://pypi.python.org/pypi/virtualenv">virtualenv</a> – Ian Bicking’s virtual environment script.</li>
<li><code class="xref py py-mod docutils literal notranslate"><span class="pre">distutils</span></code> – Packaging tools from Python standard library.</li>
<li><a class="reference external" href="https://setuptools.readthedocs.io/en/latest/">setuptools</a> – Next-generation packaging tools.</li>
<li><span class="target" id="index-0"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0302"><strong>PEP 302</strong></a> – Import Hooks</li>
<li><a class="reference internal" href="../zipfile/index.html#module-zipfile" title="zipfile: ZIP archive access"><code class="xref py py-mod docutils literal notranslate"><span class="pre">zipfile</span></code></a> – Create importable ZIP archives.</li>
<li><a class="reference internal" href="../zipimport/index.html#module-zipimport" title="zipimport: Load Python code from ZIP archives."><code class="xref py py-mod docutils literal notranslate"><span class="pre">zipimport</span></code></a> – Importer for packages in ZIP archives.</li>
</ul>
</div>
</div>
</div>



        <div id="footer-nav">
<a id="prev-link" href="../importlib/index.html"
   title="previous chapter"><i class="fa fa-arrow-circle-left"></i> importlib — Python’s Import Mechanism</a>
<a id="next-link" href="../zipimport/index.html"
   title="next chapter">zipimport — Load Python Code from ZIP Archives <i class="fa fa-arrow-circle-right"></i></a>
        </div>

        </div>
      </div>

      <div class="pure-u-1-4">
        <div class="sidebar-wrapper">
          <div class="sidebar">
<div id="sidebar-toc">
  <h5>Quick Links</h5>
  <ul>
    
    <li><a href="#package-import-paths"><i class="fa fa-caret-right"></i>Package Import Paths</a></li>
    
    <li><a href="#development-versions-of-packages"><i class="fa fa-caret-right"></i>Development Versions of Packages</a></li>
    
    <li><a href="#managing-paths-with-pkg-files"><i class="fa fa-caret-right"></i>Managing Paths with PKG Files</a></li>
    
    <li><a href="#nested-packages"><i class="fa fa-caret-right"></i>Nested Packages</a></li>
    
    <li><a href="#package-data"><i class="fa fa-caret-right"></i>Package Data</a></li>
    
  </ul>
</div>

          </div>
          <div class="sidebar"><div id="sidebar-last-updated">
  This page was last updated 2016-12-31.
</div>

          </div>
          <div class="sidebar">
<div id="sidebar-nav">
  <h5>Navigation</h5>
  <ul>
    <li><a href="../importlib/index.html"
           title="previous chapter"><i class="fa fa-arrow-circle-left"></i>importlib — Python’s Import Mechanism</a></li>
    <li><a href="../zipimport/index.html"
           title="next chapter"><i class="fa fa-arrow-circle-right"></i>zipimport — Load Python Code from ZIP Archives</a></li>
  </ul>
</div>
          </div>
          <div class="sidebar"><div id="sidebar-book"><a target="new" href="https://doughellmann.com/books/the-python-3-standard-library-by-example/"><img src="../_static/book-cover-image-med.jpg"><br>Get the book</a></div>
          </div>
          <div class="sidebar"><div id="sidebar-example-disclaimer">
<p>The output from all the example programs
from PyMOTW-3 has been generated with Python 3.7.9, unless
otherwise noted. Some of the features described here may not be
available in earlier versions of Python.</p>
<p>Looking for <a href="/2/">examples for Python 2</a>?</p>
</div>
          </div>

        </div>
      </div>

    </div>

    <div class="pure-g-r" id="footer">

      <div class="pure-u-1-3">
        <div class="footer-list">
            <h4>This Site</h4>
            <ul>
              <li><a href="../py-modindex.html"><i class="fa fa-list fa-lg"></i> Module Index</a></li>
              <li><a href="../genindex.html"><i class="fa fa-italic fa-lg"></i> Index</a></li>
            </ul>
        </div>
      </div><div class="pure-u-1-3">
          <div class="footer-content">
            <div class="socialmedia">
              <a class="sociallink" href="../index.html"
       title="Home">
      <i class="fa fa-home fa-lg"></i></a>
              <a class="sociallink" href="../about.html"
       title="About">
      <i class="fa fa-user fa-lg"></i></a>
              <a class="sociallink" href="http://www.twitter.com/pymotw"
       title="Twitter">
      <i class="fa fa-twitter fa-lg"></i></a>
              <a class="sociallink" href="https://feeds.feedburner.com/PyMOTW"
       title="Subscribe via RSS">
      <i class="fa fa-rss-square fa-lg"></i></a>
              <a class="sociallink" href="http://feedburner.google.com/fb/a/mailverify?uri=PyMOTW&amp;loc=en_US"
       title="Subscribe via Email">
      <i class="fa fa-envelope fa-lg"></i></a>
            </div>

            <div class="copyright">
              <a rel="author" href="../about.html">&copy; Copyright 2021, Doug Hellmann</a>
            </div>

            <div class="cc"><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.en_US" rel="license"><img alt="Creative Commons License BY-NC-SA" style="border-width:0; align: center;" width="88" height="31" src="data:image/png;base64,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"/></a>
            </div>

          </div></div><div class="pure-u-1-3">
          <div class="footer-list">
            <h4>Other Writing</h4>
            <ul>
              <li><a href="https://doughellmann.com/"><i class="fa fa-pencil fa-lg"></i> Blog</a></li>
              <li><a href="https://doughellmann.com/books/the-python-3-standard-library-by-example/"><i class="fa fa-book fa-lg"></i> The Python Standard Library By Example</a></li>
            </ul>
          </div>
        </div><script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-38546875-3', 'pymotw.com');
  ga('send', 'pageview');
</script>

  </body>
</html>