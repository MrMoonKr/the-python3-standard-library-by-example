<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>decimal — Fixed and Floating Point Math &mdash; PyMOTW 3</title>

    <link rel="stylesheet" href="../_static/pure-min.css" type="text/css">
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/font-awesome/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pymotw.css" type="text/css">

    <link rel="shortcut icon" type="image/png" href="../_static/favicon.png">

    <link rel="alternate" type="application/atom+xml"
          title="Doug Hellmann"
          href="https://feeds.feedburner.com/DougHellmann" />
    <link rel="alternate" type="application/atom+xml"
          title="PyMOTW Updates"
          href="https://feeds.feedburner.com/PyMOTW" />

    <meta name="verify-v1" content="5saTcOa2HLac4V85yUg3SARfun1PqT5Upu7IR/6fpv4="/>

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@pymotw" />
    <meta name="twitter:title" content="decimal — Fixed and Floating Point Math" />
    <meta name="twitter:image" content="https://pymotw.com/3/_static/logo-large.png" />

  </head>
  <body>

    <div class="pure-menu pure-menu-open pure-menu-horizontal" id="site-menu">
      <a class="pure-menu-heading" href="../index.html"><img src="../_static/logo.png"> PyMOTW-3</a>

      <ul id="top-menu">
        <li class="pure-menu-selected"><a href="../py-modindex.html"><i class="fa fa-list fa-lg"></i> Module Index</a></li>
        <li class="pure-menu-selected"><a href="../genindex.html"><i class="fa fa-italic fa-lg"></i> Index</a></li>
        <li class="pure-menu-selected"><a class="sociallink" href="http://www.twitter.com/pymotw"
       title="Twitter">
      <i class="fa fa-twitter fa-lg"></i></a></a>
        <li class="pure-menu-selected"><a class="sociallink" href="https://feeds.feedburner.com/PyMOTW"
       title="Subscribe via RSS">
      <i class="fa fa-rss-square fa-lg"></i></a></li>
      </ul>

    </div>

    <div class="pure-menu pure-menu-open pure-menu-vertical" id="breadcrumbs-menu">
      
      <ul id="breadcrumbs">
        <li class="pure-menu-selected"><a href="../numeric.html"><i class="fa fa-arrow-circle-up"></i> Mathematics</a></li>
      </ul>
    </div>

    <div class="pure-g-r" id="content-container">

      <div class="pure-u-3-4">
        <div class="content">
          
  <div class="section" id="module-decimal">
<span id="decimal-fixed-and-floating-point-math"></span><h1>decimal — Fixed and Floating Point Math<a class="headerlink" href="#module-decimal" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Purpose:</th><td class="field-body">Decimal arithmetic using fixed and floating point numbers</td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal notranslate"><span class="pre">decimal</span></code> module implements fixed and floating point
arithmetic using the model familiar to most people, rather than the
IEEE floating point version implemented by most computer hardware and
familiar to programmers.  A <code class="docutils literal notranslate"><span class="pre">Decimal</span></code> instance can represent
any number exactly, round up or down, and apply a limit to the number
of significant digits.</p>
<div class="section" id="decimal">
<h2>Decimal<a class="headerlink" href="#decimal" title="Permalink to this headline">¶</a></h2>
<p>Decimal values are represented as instances of the <code class="docutils literal notranslate"><span class="pre">Decimal</span></code>
class.  The constructor takes as argument one integer or string.
Floating point numbers can be converted to a string before being used
to create a <code class="docutils literal notranslate"><span class="pre">Decimal</span></code>, letting the caller explicitly deal with
the number of digits for values that cannot be expressed exactly using
hardware floating point representations.  Alternately, the class
method <code class="docutils literal notranslate"><span class="pre">from_float()</span></code> converts to the exact decimal
representation.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">decimal_create.py</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">decimal</span>

<span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0:&lt;25}</span><span class="s1"> </span><span class="si">{1:&lt;25}</span><span class="s1">&#39;</span>

<span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;Input&#39;</span><span class="p">,</span> <span class="s1">&#39;Output&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">25</span><span class="p">))</span>

<span class="c1"># Integer</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>

<span class="c1"># String</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;3.14&#39;</span><span class="p">,</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;3.14&#39;</span><span class="p">)))</span>

<span class="c1"># Float</span>
<span class="n">f</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">))))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:&lt;0.23g}</span><span class="s1"> </span><span class="si">{:&lt;25}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">f</span><span class="p">,</span>
    <span class="nb">str</span><span class="p">(</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="o">.</span><span class="n">from_float</span><span class="p">(</span><span class="n">f</span><span class="p">))[:</span><span class="mi">25</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>The floating point value of <code class="docutils literal notranslate"><span class="pre">0.1</span></code> is not represented as an exact
value in binary, so the representation as a <code class="docutils literal notranslate"><span class="pre">float</span></code> is
different from the <code class="docutils literal notranslate"><span class="pre">Decimal</span></code> value.  The full string
representation is truncated to 25 characters in the last line of this
output.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 decimal_create.py

Input                     Output
------------------------- -------------------------
5                         5
3.14                      3.14
0.1                       0.1
0.10000000000000000555112 0.10000000000000000555111
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Decimals</span></code> can also be created from tuples
containing a sign flag (<code class="docutils literal notranslate"><span class="pre">0</span></code> for positive, <code class="docutils literal notranslate"><span class="pre">1</span></code> for negative), a
<code class="docutils literal notranslate"><span class="pre">tuple</span></code> of digits, and an integer exponent.</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">decimal_tuple.py</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">decimal</span>

<span class="c1"># Tuple</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Input  :&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Decimal:&#39;</span><span class="p">,</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>The tuple-based representation is less convenient to create, but does
offer a portable way of exporting decimal values without losing
precision.  The tuple form can be transmitted through the network or
stored in a database that does not support accurate decimal values,
then turned back into a <code class="docutils literal notranslate"><span class="pre">Decimal</span></code> instance later.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 decimal_tuple.py

Input  : (1, (1, 1), -2)
Decimal: -0.11
</pre></div>
</div>
</div>
<div class="section" id="formatting">
<h2>Formatting<a class="headerlink" href="#formatting" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Decimal</span></code> responds to Python’s <a class="reference external" href="https://docs.python.org/3.5/library/string.html#formatspec">string formatting protocol</a>, using
the same syntax and options as other numerical types.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">decimal_format.py</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">decimal</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="mf">1.1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Precision:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.18}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Width and precision combined:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:5.1f}</span><span class="s1"> </span><span class="si">{:5.1g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:5.2f}</span><span class="s1"> </span><span class="si">{:5.2g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:5.2f}</span><span class="s1"> </span><span class="si">{:5.2g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Zero padding:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:05.1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:05.2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:05.3}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>The format strings can control the width of the output, the precision
(number of significant digits), and how to pad the value to fill the
width.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 decimal_format.py

Precision:
1
1.1
1.10
1.10000000000000009

Width and precision combined:
  1.1     1
 1.10   1.1
 1.10   1.1

Zero padding:
00001
001.1
01.10
</pre></div>
</div>
</div>
<div class="section" id="arithmetic">
<h2>Arithmetic<a class="headerlink" href="#arithmetic" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Decimal</span></code> overloads the simple arithmetic operators so
instances can be manipulated in much the same way as the built-in
numeric types.</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">decimal_operators.py</span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">decimal</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;5.1&#39;</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;3.14&#39;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">d</span> <span class="o">=</span> <span class="mf">3.14</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a     =&#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;b     =&#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;c     =&#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;d     =&#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a + b =&#39;</span><span class="p">,</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a - b =&#39;</span><span class="p">,</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a * b =&#39;</span><span class="p">,</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a / b =&#39;</span><span class="p">,</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a + c =&#39;</span><span class="p">,</span> <span class="n">a</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a - c =&#39;</span><span class="p">,</span> <span class="n">a</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a * c =&#39;</span><span class="p">,</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a / c =&#39;</span><span class="p">,</span> <span class="n">a</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a + d =&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">d</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Decimal</span></code> operators also accept integer arguments, but floating
point values must be converted to <code class="docutils literal notranslate"><span class="pre">Decimal</span></code> instances.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 decimal_operators.py

a     = Decimal(&#39;5.1&#39;)
b     = Decimal(&#39;3.14&#39;)
c     = 4
d     = 3.14

a + b = 8.24
a - b = 1.96
a * b = 16.014
a / b = 1.624203821656050955414012739

a + c = 9.1
a - c = 1.1
a * c = 20.4
a / c = 1.275

a + d = unsupported operand type(s) for +: &#39;decimal.Decimal&#39; and
 &#39;float&#39;
</pre></div>
</div>
<p>Beyond basic arithmetic, <code class="docutils literal notranslate"><span class="pre">Decimal</span></code> includes the methods to find
the base 10 and natural logarithms.  The return values from
<code class="docutils literal notranslate"><span class="pre">log10()</span></code> and <code class="docutils literal notranslate"><span class="pre">ln()</span></code> are <code class="docutils literal notranslate"><span class="pre">Decimal</span></code> instances, so they
can be used directly in formulas with other values.</p>
</div>
<div class="section" id="special-values">
<h2>Special Values<a class="headerlink" href="#special-values" title="Permalink to this headline">¶</a></h2>
<p>In addition to the expected numerical values, <code class="docutils literal notranslate"><span class="pre">Decimal</span></code> can
represent several special values, including positive and negative
values for infinity, “not a number”, and zero.</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">decimal_special.py</span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">decimal</span>

<span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Infinity&#39;</span><span class="p">,</span> <span class="s1">&#39;NaN&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">value</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Math with infinity</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Infinity + 1:&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;Infinity&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-Infinity + 1:&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;-Infinity&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Print comparing NaN</span>
<span class="nb">print</span><span class="p">(</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;NaN&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;Infinity&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;NaN&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>Adding to infinite values returns another infinite value.  Comparing
for equality with <code class="docutils literal notranslate"><span class="pre">NaN</span></code> always returns false and comparing for
inequality always returns true.  Comparing for sort order against
<code class="docutils literal notranslate"><span class="pre">NaN</span></code> is undefined and results in an error.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 decimal_special.py

Infinity -Infinity
NaN -NaN
0 -0

Infinity + 1: Infinity
-Infinity + 1: -Infinity
False
True
</pre></div>
</div>
</div>
<div class="section" id="context">
<h2>Context<a class="headerlink" href="#context" title="Permalink to this headline">¶</a></h2>
<p>So far, all of the examples have used the default behaviors of the
<code class="docutils literal notranslate"><span class="pre">decimal</span></code> module. It is possible to override settings such as the
precision maintained, how rounding is performed, error handling,
etc. by using a <em>context</em>.  Contexts can be applied for all
<code class="docutils literal notranslate"><span class="pre">Decimal</span></code> instances in a thread or locally within a small code
region.</p>
<div class="section" id="current-context">
<h3>Current Context<a class="headerlink" href="#current-context" title="Permalink to this headline">¶</a></h3>
<p>To retrieve the current global context, use <code class="docutils literal notranslate"><span class="pre">getcontext</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">decimal_getcontext.py</span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">decimal</span>

<span class="n">context</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Emax     =&#39;</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">Emax</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Emin     =&#39;</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">Emin</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;capitals =&#39;</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">capitals</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;prec     =&#39;</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">prec</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rounding =&#39;</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">rounding</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;flags    =&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">{}</span><span class="s1">: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;traps    =&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">traps</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">{}</span><span class="s1">: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>This example script shows the public properties of a <code class="docutils literal notranslate"><span class="pre">Context</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 decimal_getcontext.py

Emax     = 999999
Emin     = -999999
capitals = 1
prec     = 28
rounding = ROUND_HALF_EVEN
flags    =
  &lt;class &#39;decimal.InvalidOperation&#39;&gt;: False
  &lt;class &#39;decimal.FloatOperation&#39;&gt;: False
  &lt;class &#39;decimal.DivisionByZero&#39;&gt;: False
  &lt;class &#39;decimal.Overflow&#39;&gt;: False
  &lt;class &#39;decimal.Underflow&#39;&gt;: False
  &lt;class &#39;decimal.Subnormal&#39;&gt;: False
  &lt;class &#39;decimal.Inexact&#39;&gt;: False
  &lt;class &#39;decimal.Rounded&#39;&gt;: False
  &lt;class &#39;decimal.Clamped&#39;&gt;: False
traps    =
  &lt;class &#39;decimal.InvalidOperation&#39;&gt;: True
  &lt;class &#39;decimal.FloatOperation&#39;&gt;: False
  &lt;class &#39;decimal.DivisionByZero&#39;&gt;: True
  &lt;class &#39;decimal.Overflow&#39;&gt;: True
  &lt;class &#39;decimal.Underflow&#39;&gt;: False
  &lt;class &#39;decimal.Subnormal&#39;&gt;: False
  &lt;class &#39;decimal.Inexact&#39;&gt;: False
  &lt;class &#39;decimal.Rounded&#39;&gt;: False
  &lt;class &#39;decimal.Clamped&#39;&gt;: False
</pre></div>
</div>
</div>
<div class="section" id="precision">
<h3>Precision<a class="headerlink" href="#precision" title="Permalink to this headline">¶</a></h3>
<p>The <code class="xref py py-attr docutils literal notranslate"><span class="pre">prec</span></code> attribute of the context controls the precision maintained
for new values created as a result of arithmetic.  Literal values are
maintained as described.</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">decimal_precision.py</span><a class="headerlink" href="#id7" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">decimal</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;0.123456&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span><span class="p">()</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="n">i</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">d</span> <span class="o">*</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>To change the precision, assign a new value between <code class="docutils literal notranslate"><span class="pre">1</span></code> and
<code class="docutils literal notranslate"><span class="pre">decimal.MAX_PREC</span></code> directly to the attribute.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 decimal_precision.py

1 : 0.123456 0.1
2 : 0.123456 0.12
3 : 0.123456 0.123
4 : 0.123456 0.1235
</pre></div>
</div>
</div>
<div class="section" id="rounding">
<h3>Rounding<a class="headerlink" href="#rounding" title="Permalink to this headline">¶</a></h3>
<p>There are several options for rounding to keep values within the
desired precision.</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">ROUND_CEILING</span></code></dt>
<dd>Always round upwards towards infinity.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ROUND_DOWN</span></code></dt>
<dd>Always round toward zero.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ROUND_FLOOR</span></code></dt>
<dd>Always round down towards negative infinity.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ROUND_HALF_DOWN</span></code></dt>
<dd>Rounds away from zero if the last significant digit is greater than
or equal to 5, otherwise toward zero.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ROUND_HALF_EVEN</span></code></dt>
<dd>Like <code class="docutils literal notranslate"><span class="pre">ROUND_HALF_DOWN</span></code> except that if the value is 5 then the
preceding digit is examined.  Even values cause the result to be
rounded down and odd digits cause the result to be rounded up.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ROUND_HALF_UP</span></code></dt>
<dd>Like <code class="docutils literal notranslate"><span class="pre">ROUND_HALF_DOWN</span></code> except if the last significant digit
is 5 the value is rounded away from zero.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ROUND_UP</span></code></dt>
<dd>Round away from zero.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ROUND_05UP</span></code></dt>
<dd>Round away from zero if the last digit is <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">5</span></code>, otherwise
towards zero.</dd>
</dl>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">decimal_rounding.py</span><a class="headerlink" href="#id8" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">decimal</span>

<span class="n">context</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span><span class="p">()</span>

<span class="n">ROUNDING_MODES</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;ROUND_CEILING&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ROUND_DOWN&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ROUND_FLOOR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ROUND_HALF_DOWN&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ROUND_HALF_EVEN&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ROUND_HALF_UP&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ROUND_UP&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ROUND_05UP&#39;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">header_fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:10}</span><span class="s1"> &#39;</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{:^8}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">header_fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="s1">&#39; &#39;</span><span class="p">,</span>
    <span class="s1">&#39;1/8 (1)&#39;</span><span class="p">,</span> <span class="s1">&#39;-1/8 (1)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1/8 (2)&#39;</span><span class="p">,</span> <span class="s1">&#39;-1/8 (2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1/8 (3)&#39;</span><span class="p">,</span> <span class="s1">&#39;-1/8 (3)&#39;</span><span class="p">,</span>
<span class="p">))</span>
<span class="k">for</span> <span class="n">rounding_mode</span> <span class="ow">in</span> <span class="n">ROUNDING_MODES</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:10}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rounding_mode</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
          <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">precision</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
        <span class="n">context</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="n">precision</span>
        <span class="n">context</span><span class="o">.</span><span class="n">rounding</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">decimal</span><span class="p">,</span> <span class="n">rounding_mode</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^8}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^8}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>This program shows the effect of rounding the same value to different
levels of precision using the different algorithms.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 decimal_rounding.py

           1/8 (1)  -1/8 (1) 1/8 (2)  -1/8 (2) 1/8 (3)  -1/8 (3)
CEILING      0.2      -0.1     0.13    -0.12    0.125    -0.125

DOWN         0.1      -0.1     0.12    -0.12    0.125    -0.125

FLOOR        0.1      -0.2     0.12    -0.13    0.125    -0.125

HALF_DOWN    0.1      -0.1     0.12    -0.12    0.125    -0.125

HALF_EVEN    0.1      -0.1     0.12    -0.12    0.125    -0.125

HALF_UP      0.1      -0.1     0.13    -0.13    0.125    -0.125

UP           0.2      -0.2     0.13    -0.13    0.125    -0.125

05UP         0.1      -0.1     0.12    -0.12    0.125    -0.125
</pre></div>
</div>
</div>
<div class="section" id="local-context">
<h3>Local Context<a class="headerlink" href="#local-context" title="Permalink to this headline">¶</a></h3>
<p>The context can be applied to a block of code using the
<code class="docutils literal notranslate"><span class="pre">with</span></code> statement.</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">decimal_context_manager.py</span><a class="headerlink" href="#id9" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">decimal</span>

<span class="k">with</span> <span class="n">decimal</span><span class="o">.</span><span class="n">localcontext</span><span class="p">()</span> <span class="k">as</span> <span class="n">c</span><span class="p">:</span>
    <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Local precision:&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">prec</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;3.14 / 3 =&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;3.14&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span><span class="p">))</span>

<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Default precision:&#39;</span><span class="p">,</span> <span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span><span class="p">()</span><span class="o">.</span><span class="n">prec</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;3.14 / 3 =&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;3.14&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Context</span></code> supports the context manager API used by
<code class="docutils literal notranslate"><span class="pre">with</span></code>, so the settings only apply within the block.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 decimal_context_manager.py

Local precision: 2
3.14 / 3 = 1.0

Default precision: 28
3.14 / 3 = 1.046666666666666666666666667
</pre></div>
</div>
</div>
<div class="section" id="per-instance-context">
<h3>Per-Instance Context<a class="headerlink" href="#per-instance-context" title="Permalink to this headline">¶</a></h3>
<p>Contexts also can be used to construct <code class="docutils literal notranslate"><span class="pre">Decimal</span></code> instances, which
then inherit the precision and rounding arguments to the conversion
from the context.</p>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">decimal_instance_context.py</span><a class="headerlink" href="#id10" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">decimal</span>

<span class="c1"># Set up a context with limited precision</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># Create our constant</span>
<span class="n">pi</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">create_decimal</span><span class="p">(</span><span class="s1">&#39;3.1415&#39;</span><span class="p">)</span>

<span class="c1"># The constant value is rounded off</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PI    :&#39;</span><span class="p">,</span> <span class="n">pi</span><span class="p">)</span>

<span class="c1"># The result of using the constant uses the global context</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RESULT:&#39;</span><span class="p">,</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;2.01&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">pi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This lets an application select the precision of constant values
separately from the precision of user data, for example.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 decimal_instance_context.py

PI    : 3.14
RESULT: 6.3114
</pre></div>
</div>
</div>
<div class="section" id="threads">
<h3>Threads<a class="headerlink" href="#threads" title="Permalink to this headline">¶</a></h3>
<p>The “global” context is actually thread-local, so each thread can
potentially be configured using different values.</p>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text">decimal_thread_context.py</span><a class="headerlink" href="#id11" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">decimal</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">from</span> <span class="nn">queue</span> <span class="k">import</span> <span class="n">PriorityQueue</span>


<span class="k">class</span> <span class="nc">Multiplier</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">prec</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="n">prec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="n">q</span>
        <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">getcontext</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">c</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prec</span>
        <span class="n">decimal</span><span class="o">.</span><span class="n">setcontext</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">prec</span><span class="p">,</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">))</span>


<span class="n">a</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;3.14&#39;</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1.234&#39;</span><span class="p">)</span>
<span class="c1"># A PriorityQueue will return values sorted by precision,</span>
<span class="c1"># no matter what order the threads finish.</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">PriorityQueue</span><span class="p">()</span>
<span class="n">threads</span> <span class="o">=</span> <span class="p">[</span><span class="n">Multiplier</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
    <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
    <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">prec</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">  </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prec</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>This example creates a new context using the specified, then installs
it within each thread.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 decimal_thread_context.py

1  4
2  3.9
3  3.87
4  3.875
5  3.8748
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference external" href="https://docs.python.org/3.7/library/decimal.html">Standard library documentation for decimal</a></li>
<li><a class="reference internal" href="../porting_notes.html#porting-decimal"><span class="std std-ref">Python 2 to 3 porting notes for decimal</span></a></li>
<li><a class="reference external" href="https://en.wikipedia.org/wiki/Floating_point">Wikipedia: Floating Point</a> – Article on
floating point representations and arithmetic.</li>
<li><a class="reference external" href="https://docs.python.org/tutorial/floatingpoint.html">Floating Point Arithmetic: Issues and Limitations</a> –
Article from the Python tutorial describing floating point math
representation issues.</li>
</ul>
</div>
</div>
</div>
</div>



        <div id="footer-nav">
<a id="prev-link" href="../numeric.html"
   title="previous chapter"><i class="fa fa-arrow-circle-left"></i> Mathematics</a>
<a id="next-link" href="../fractions/index.html"
   title="next chapter">fractions — Rational Numbers <i class="fa fa-arrow-circle-right"></i></a>
        </div>

        </div>
      </div>

      <div class="pure-u-1-4">
        <div class="sidebar-wrapper">
          <div class="sidebar">
<div id="sidebar-toc">
  <h5>Quick Links</h5>
  <ul>
    
    <li><a href="#decimal"><i class="fa fa-caret-right"></i>Decimal</a></li>
    
    <li><a href="#formatting"><i class="fa fa-caret-right"></i>Formatting</a></li>
    
    <li><a href="#arithmetic"><i class="fa fa-caret-right"></i>Arithmetic</a></li>
    
    <li><a href="#special-values"><i class="fa fa-caret-right"></i>Special Values</a></li>
    
    <li><a href="#context"><i class="fa fa-caret-right"></i>Context</a></li>
    
    <li><a href="#current-context"><i class="fa fa-caret-right"></i>Current Context</a></li>
    
    <li><a href="#precision"><i class="fa fa-caret-right"></i>Precision</a></li>
    
    <li><a href="#rounding"><i class="fa fa-caret-right"></i>Rounding</a></li>
    
    <li><a href="#local-context"><i class="fa fa-caret-right"></i>Local Context</a></li>
    
    <li><a href="#per-instance-context"><i class="fa fa-caret-right"></i>Per-Instance Context</a></li>
    
    <li><a href="#threads"><i class="fa fa-caret-right"></i>Threads</a></li>
    
  </ul>
</div>

          </div>
          <div class="sidebar"><div id="sidebar-last-updated">
  This page was last updated 2016-12-29.
</div>

          </div>
          <div class="sidebar">
<div id="sidebar-nav">
  <h5>Navigation</h5>
  <ul>
    <li><a href="../numeric.html"
           title="previous chapter"><i class="fa fa-arrow-circle-left"></i>Mathematics</a></li>
    <li><a href="../fractions/index.html"
           title="next chapter"><i class="fa fa-arrow-circle-right"></i>fractions — Rational Numbers</a></li>
  </ul>
</div>
          </div>
          <div class="sidebar"><div id="sidebar-book"><a target="new" href="https://doughellmann.com/books/the-python-3-standard-library-by-example/"><img src="../_static/book-cover-image-med.jpg"><br>Get the book</a></div>
          </div>
          <div class="sidebar"><div id="sidebar-example-disclaimer">
<p>The output from all the example programs
from PyMOTW-3 has been generated with Python 3.7.9, unless
otherwise noted. Some of the features described here may not be
available in earlier versions of Python.</p>
<p>Looking for <a href="/2/">examples for Python 2</a>?</p>
</div>
          </div>

        </div>
      </div>

    </div>

    <div class="pure-g-r" id="footer">

      <div class="pure-u-1-3">
        <div class="footer-list">
            <h4>This Site</h4>
            <ul>
              <li><a href="../py-modindex.html"><i class="fa fa-list fa-lg"></i> Module Index</a></li>
              <li><a href="../genindex.html"><i class="fa fa-italic fa-lg"></i> Index</a></li>
            </ul>
        </div>
      </div><div class="pure-u-1-3">
          <div class="footer-content">
            <div class="socialmedia">
              <a class="sociallink" href="../index.html"
       title="Home">
      <i class="fa fa-home fa-lg"></i></a>
              <a class="sociallink" href="../about.html"
       title="About">
      <i class="fa fa-user fa-lg"></i></a>
              <a class="sociallink" href="http://www.twitter.com/pymotw"
       title="Twitter">
      <i class="fa fa-twitter fa-lg"></i></a>
              <a class="sociallink" href="https://feeds.feedburner.com/PyMOTW"
       title="Subscribe via RSS">
      <i class="fa fa-rss-square fa-lg"></i></a>
              <a class="sociallink" href="http://feedburner.google.com/fb/a/mailverify?uri=PyMOTW&amp;loc=en_US"
       title="Subscribe via Email">
      <i class="fa fa-envelope fa-lg"></i></a>
            </div>

            <div class="copyright">
              <a rel="author" href="../about.html">&copy; Copyright 2021, Doug Hellmann</a>
            </div>

            <div class="cc"><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.en_US" rel="license"><img alt="Creative Commons License BY-NC-SA" style="border-width:0; align: center;" width="88" height="31" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAAAfCAMAAABUFvrSAAAABGdBTUEAALGOfPtRkwAAAf5QTFRF////////////AAAADQwNDQ4NDg4OEBAQGRkZGxsbHxscICAgIx8gJCQkKCUmKCgoKCkoKSkpKSopKicnKioqLS0tMDAwMS0uMjExMjMxNTY1Pj8+Pzc5Pzs8QEBAQ0RDUFBQUFFQWldYXV5dYGBgY19haGVmbmxscHBwcHJvdXJzdnN0eHV2eXx5en15fH98fX98fnt8f4F+gICAgoWChIGChIWEhIaEh4aHiYyJjIqLjoeLj4+PkY+PkZORkZSRk5iTlZmUlpmWmJaXmpiZnp2dnqCdn5aan5+fn6Oeoqaho6Gho6ijpqqmq7GqrKurrLKrrbOsrrOtrrStr6+vr7Kvr7Sur7WusLOvsLWvsLavsbewsrexsrixs7iytLmztLqztbW1tbq0tru1t7y2uL23ub64ub65urm5ur+5ur+6u8C6u8C7vMC8vMG7vMG8vcK8vcK9vsK9vsO+v7+/v8O+v8S+wMS/wMW/wMXAwcXAwsfCw8fCw8jDxMfDxMjDxMnExcnExcnFxsrFxsrGx8vHyMfHyMzHyMzIycjIyc3Iyc3Jys3Jy8rLy87Ky8/Ky8/LzM/LzNDLzNDMzdDMzdHMzdHNztHNztLOz8/Pz9PP0NPP0NTQ0dTQ0dTR0tXR0tXS09bS1tXV39/f4N/g4+Pj6Ofn7+/v8fHx////rrSdFQAAAAN0Uk5TAAoO5yEBUwAAA+FJREFUSMe1lo9301QUx6uXUmaf0qJ26iTrRoVinUzjQNR1gAyH6Lqx6XTDoVvXbU7qhA5m7CgYWaTDlLa6AiFsba3t+y+9Sdr8OvVMi7zTnLTf5H7ee9/73n11PA1PpDkcADPRWPwKt8YLG2I2n89m7gh8iluJz0dnpqe+HBsdHRn+7w3JyF1cvpbk05mCJG8Xi9uPpMLdNJ9cXV5UyBNjoyMtkR2A3B9Tt8SCfLTTqUzC2XlMvpcRbnA/IPmryYnzoyM9XuWBt8eI21FBcAy5Qk4KtxkGtQ1I+fRNbnk+evHC5NhJDwATDDIAnhNa1ImdFQTHr6WEvNyFPFeATSTYgAu/dl3/I31jNR6bnZ76eDf4yxRb2Q+71aiz/0JB8JXkrZzCdbFVqrUhRHuu54XkytLczAUvBFADUB6ARwnyqEp/t02prK9XdAXBHC9KyPWVqd6qPhyzlOG55dhsL/hLDTD1A3rYAy+dRu6eXaGKruA75wi2hbqigNd+LYSRW6XUSh64l05dXYruA1OPZfAOD3vhObL/ILDvQkRXynSdvPpaiJB+TVHAfEZuA9d9amlVF7TJd3nu+xgwyu8AqNOnDGAM8/obOLhQpWQotPYReZ/SQdKuKQpY2DwKwFJbGwI4VhCSlxchSFUnNC+CCgaV9RAKoZKh1J4le9FmQv5SFQW88aATXGhEws8wrHb7AANc0CndQS+ag5ERaieke0FXvnkxoYL/1MGi7FSmmVBXMDOu3gLK5J2PMjdXv2tmBX6pDdKSkq39DWXh3G1KI4QYVmS3AHCIPnCXE+4hHy6PcfeQ6sV2lufiL2jJ0wasp4p2k/Z2CEXeeqahDBLS1/c8+dBIXq4IkFAiWQ1QtxtnUMz/wsXfBj+1LzdUKn17dvXXzEqfMoFDNWO57QCe22dskKB5g7zXbVN+i0RKumKxonrfzaIVys2wYu7TVrd0PXn1rOnJC4JTFjF5c19/gnXLFwj6jJJz1rOjoi63LnBRfbmNM+qNunG5baSufhu9OPX5my2VTWEzrHrRbIP8dHl+dnpyrIVDBME/q1u6/E9bGmt9i2AsQmeaFaFwIb22soSlfuL8SEtgOCJKB5BsKkNltWyK7zzWMY3X4exDc6GvsljoX5FzR+BxwdCbf3jAdjTJv5/S39H2B2iXpmgXpWB7iVrB0JuVzpgP07CUO2WKqX+oiVL/benKImhgOIzHf7hx/A/IBdHsQ6Nsmruilo4afVFqB8PLn2U2H8hbxeKWjH9YvuiwxNiMaNhALZptCg5d7zh+Sczmclnx0vEOax6ajdjucSMPTcD/97/Cp54Q929ZZbgcR3o0hAAAAABJRU5ErkJggg=="/></a>
            </div>

          </div></div><div class="pure-u-1-3">
          <div class="footer-list">
            <h4>Other Writing</h4>
            <ul>
              <li><a href="https://doughellmann.com/"><i class="fa fa-pencil fa-lg"></i> Blog</a></li>
              <li><a href="https://doughellmann.com/books/the-python-3-standard-library-by-example/"><i class="fa fa-book fa-lg"></i> The Python Standard Library By Example</a></li>
            </ul>
          </div>
        </div><script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-38546875-3', 'pymotw.com');
  ga('send', 'pageview');
</script>

  </body>
</html>